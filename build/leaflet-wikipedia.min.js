!function(e,i){"function"==typeof define&&define.amd?define(["leaflet","jsonp"],i):"object"==typeof exports?module.exports=i(require("leaflet"),require("jsonp")):e.L=i(e.L,e.JSONP)}(this,function(e,i){"use strict";return e.Icon.WikipediaIcon=e.Icon.extend({options:{iconUrl:"images/wikipedia-icon.png",iconRetinaUrl:"images/wikipedia-icon-2x.png",iconSize:[40,40],popupAnchor:[0,-20]}}),e.icon.wikipediaIcon=function(){return new e.Icon.WikipediaIcon},e.LayerGroup.WikipediaLayer=e.LayerGroup.extend({PAGE:"?curid=",API:"w/api.php",options:{url:"https://en.wikipedia.org/",limit:100,popupOnMouseover:!1,clearOutsideBounds:!1,target:"_self"},initialize:function(i){i=i||{},e.Util.setOptions(this,i),this._layers={}},onAdd:function(e){e.on("moveend",this.requestData,this),this._map=e,this.requestData()},onRemove:function(e){e.off("moveend",this.requestData,this),this.clearMarkers()},requestData:function(){var e=this._map.getCenter(),t={format:"json",action:"query",list:"geosearch",gslimit:this.options.limit,gsradius:this.getRadius(),gscoord:e.lat+"|"+e.lng},n=this;i.get(this.options.url+this.API,t,function(e){n.parseData(e)})},getMarker:function(i){var t=e.marker([i.lat,i.lon],{icon:e.icon.wikipediaIcon()}),n=this.options.url+this.PAGE+i.pageid,o='<a href="'+n+'" target="'+this.options.target+'">'+i.title+"</a>";return t.bindPopup(o),this.options.popupOnMouseover&&t.on("mouseover",function(e){e.target.openPopup()}),t},addMarker:function(e){var i=this.getMarker(e),t=e.pageid;this._layers[t]||(this._layers[t]=i,this._map.addLayer(i))},parseData:function(e){var i=e.query.geosearch,t=0,n=i.length;for(t;n>t;t+=1)this.addMarker(i[t]);this.options.clearOutsideBounds&&this.clearOutsideBounds()},getRadius:function(){var e=this._map.getBounds(),i=e.getNorthWest(),t=e.getSouthEast(),n=i.distanceTo(t)/2;return n>1e4?1e4:n},clearOutsideBounds:function(){var e,i,t=this._map.getBounds();for(i in this._layers)this._layers.hasOwnProperty(i)&&(e=this._layers[i].getLatLng(),t.contains(e)||(this._map.removeLayer(this._layers[i]),delete this._layers[i]))}}),e.layerGroup.wikipediaLayer=function(i){return new e.LayerGroup.WikipediaLayer(i)},e});